/*! AeroGear JavaScript Library - v1.0.0.M2 - 2013-01-09
* https://github.com/aerogear/aerogear-js
* JBoss, Home of Professional Open Source
* Copyright Red Hat, Inc., and individual contributors
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var AeroGear={};AeroGear.Core=function(){if(this instanceof AeroGear.Core)throw"Invalid instantiation of base class AeroGear.Core";this.add=function(e){var t,a,r=this[this.collectionName]||{};if(!e)return this;if("string"==typeof e)r[e]=AeroGear[this.lib].adapters[this.type](e);else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)a=e[t],"string"==typeof a?r[a]=AeroGear[this.lib].adapters[this.type](a):r[a.name]=AeroGear[this.lib].adapters[a.type||this.type](a.name,a.settings||{});else r[e.name]=AeroGear[this.lib].adapters[e.type||this.type](e.name,e.settings||{});return this[this.collectionName]=r,this},this.remove=function(e){var t,a,r=this[this.collectionName]||{};if("string"==typeof e)delete r[e];else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)a=e[t],"string"==typeof a?delete r[a]:delete r[a.name];else e&&delete r[e.name];return this[this.collectionName]=r,this}},AeroGear.isArray=function(e){return"[object Array]"==={}.toString.call(e)},function(e,t){e.ajax=function(a,r){var s=t.Deferred(function(){var s=this,n=t.extend({},{contentType:"application/json",dataType:"json"},r);this.done(n.success),this.fail(n.error),this.always(n.complete);var o=t.extend({},n,{success:function(e,t,a){s.resolve("string"==typeof e&&"json"===o.dataType?JSON.parse(e):e,t,a)},error:function(e,t,a){if("json"===o.dataType)try{e.responseJSON=JSON.parse(e.responseText)}catch(r){}s.reject(e,t,a)},complete:function(e,t){s.resolve(e,t)}});"application/json"!==o.contentType||!o.data||"POST"!==o.type&&"PUT"!==o.type||(o.data=JSON.stringify(o.data)),e.Auth&&!a.isAuthenticated()?this.reject("auth","Error: Authentication Required"):a.addAuthIdentifier?t.ajax(a.addAuthIdentifier(o)):t.ajax(o)}),n=s.promise();return n.success=s.done,n.error=s.fail,n.complete=s.always,n}}(AeroGear,jQuery),function(){function e(e,t,a){var r=t&&a||0,s=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>s&&(t[r+s++]=g[e])});16>s;)t[r+s++]=0;return t}function t(e,t){var a=t||0,r=l;return r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+"-"+r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]+r[e[a++]]}function a(e,a,r){var s=a&&r||0,n=a||[];e=e||{};var o=null!=e.clockseq?e.clockseq:v,i=null!=e.msecs?e.msecs:(new Date).getTime(),u=null!=e.nsecs?e.nsecs:S+1,c=i-D+(u-S)/1e4;if(0>c&&null==e.clockseq&&(o=16383&o+1),(0>c||i>D)&&null==e.nsecs&&(u=0),u>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");D=i,S=u,v=o,i+=122192928e5;var h=(1e4*(268435455&i)+u)%4294967296;n[s++]=255&h>>>24,n[s++]=255&h>>>16,n[s++]=255&h>>>8,n[s++]=255&h;var p=268435455&1e4*(i/4294967296);n[s++]=255&p>>>8,n[s++]=255&p,n[s++]=16|15&p>>>24,n[s++]=255&p>>>16,n[s++]=128|o>>>8,n[s++]=255&o;for(var f=e.node||A,d=0;6>d;d++)n[s+d]=f[d];return a?a:t(n)}function r(e,a,r){var s=a&&r||0;"string"==typeof e&&(a="binary"==e?new d(16):null,e=null),e=e||{};var n=e.random||(e.rng||f)();if(n[6]=64|15&n[6],n[8]=128|63&n[8],a)for(var o=0;16>o;o++)a[s+o]=n[o];return a||t(n)}var s,n,o,i=this,u=Array(16);if(s=function(){for(var e,e,t=u,a=0,a=0;16>a;a++)0==(3&a)&&(e=4294967296*Math.random()),t[a]=255&e>>>((3&a)<<3);return t},i.crypto&&crypto.getRandomValues){var c=new Uint32Array(4);o=function(){crypto.getRandomValues(c);for(var e=0;16>e;e++)u[e]=255&c[e>>2]>>>8*(3&e);return u}}try{var h=require("crypto").randomBytes;n=h&&function(){return h(16)}}catch(p){}for(var f=n||o||s,d="function"==typeof Buffer?Buffer:Array,l=[],g={},y=0;256>y;y++)l[y]=(y+256).toString(16).substr(1),g[l[y]]=y;var m=f(),A=[1|m[0],m[1],m[2],m[3],m[4],m[5]],v=16383&(m[6]<<8|m[7]),D=0,S=0,T=r;if(T.v1=a,T.v4=r,T.parse=e,T.unparse=t,T.BufferClass=d,T.mathRNG=s,T.nodeRNG=n,T.whatwgRNG=o,"undefined"!=typeof module)module.exports=T;else{var b=i.uuid;T.noConflict=function(){return i.uuid=b,T},i.uuid=T}}(),function(e){e.Pipeline=function(t){return this instanceof e.Pipeline?(e.Core.call(this),this.lib="Pipeline",this.type=t?t.type||"Rest":"Rest",this.collectionName="pipes",this.add(t),undefined):new e.Pipeline(t)},e.Pipeline.prototype=e.Core,e.Pipeline.constructor=e.Pipeline,e.Pipeline.adapters={}}(AeroGear,jQuery),function(e,t){e.Pipeline.adapters.Rest=function(t,a){if(!(this instanceof e.Pipeline.adapters.Rest))return new e.Pipeline.adapters.Rest(t,a);a=a||{};var r=a.endpoint||t,s={url:a.baseURL?a.baseURL+r:r},n=a.recordId||"id",o=a.authenticator||null;this.isAuthenticated=function(){return o?o.isAuthenticated():!0},this.addAuthIdentifier=function(e){return o?o.addAuthIdentifier(e):e},this.deauthorize=function(){o&&o.deauthorize()},this.getAjaxSettings=function(){return s},this.getRecordId=function(){return n}},e.Pipeline.adapters.Rest.prototype.read=function(a){var r,s,n,o,i=this.getRecordId(),u=this.getAjaxSettings();return a=a||{},r=a[i]?u.url+"/"+a[i]:u.url,s=function(t){var r,s=a.stores?e.isArray(a.stores)?a.stores:[a.stores]:[];if(s.length)for(r in s)s[r].save(t,!0);a.success&&a.success.apply(this,arguments)},n=function(t){var r,s=a.stores?e.isArray(a.stores)?a.stores:[a.stores]:[];if("auth"===t&&s.length)for(r in s)s[r].remove();a.error&&a.error.apply(this,arguments)},o={type:"GET",data:a.query,success:s,error:n,url:r,statusCode:a.statusCode,complete:a.complete},a.jsonp&&(o.dataType="jsonp",o.jsonp=a.jsonp.callback?a.jsonp.callback:"callback",a.jsonp.customCallback&&(o.jsonpCallback=a.jsonp.customCallback)),e.ajax(this,t.extend({},this.getAjaxSettings(),o))},e.Pipeline.adapters.Rest.prototype.save=function(a,r){var s,n,o,i,u,c=this.getRecordId(),h=this.getAjaxSettings();return a=a||{},r=r||{},s=a[c]?"PUT":"POST",n=a[c]?h.url+"/"+a[c]:h.url,o=function(t){var a,s=e.isArray(r.stores)?r.stores:[r.stores];if(r.stores)for(a in s)s[a].save(t);r.success&&r.success.apply(this,arguments)},i=function(t){var a,s=r.stores?e.isArray(r.stores)?r.stores:[r.stores]:[];if("auth"===t&&s.length)for(a in s)s[a].remove();r.error&&r.error.apply(this,arguments)},u={data:a,type:s,url:n,success:o,error:i,statusCode:r.statusCode,complete:r.complete},e.ajax(this,t.extend({},h,u))},e.Pipeline.adapters.Rest.prototype.remove=function(a,r){var s,n,o,i,u,c=this.getRecordId(),h=this.getAjaxSettings(),p="";return"string"==typeof a||"number"==typeof a?s=a:a&&a[c]?s=a[c]:a&&!r&&(r=a),r=r||{},p=s?"/"+s:"",n=h.url+p,o=function(){var t,a;if(r.stores){t=e.isArray(r.stores)?r.stores:[r.stores];for(a in t)t[a].remove(s)}r.success&&r.success.apply(this,arguments)},i=function(t){var a,s=r.stores?e.isArray(r.stores)?r.stores:[r.stores]:[];if("auth"===t&&s.length)for(a in s)s[a].remove();r.error&&r.error.apply(this,arguments)},u={type:"DELETE",url:n,success:o,error:i,statusCode:r.statusCode,complete:r.complete},e.ajax(this,t.extend({},h,u))}}(AeroGear,jQuery,uuid),function(e){e.DataManager=function(t){return this instanceof e.DataManager?(e.Core.call(this),this.lib="DataManager",this.type=t?t.type||"Memory":"Memory",this.collectionName="stores",this.add(t),undefined):new e.DataManager(t)},e.DataManager.prototype=e.Core,e.DataManager.constructor=e.DataManager,e.DataManager.adapters={},e.DataManager.STATUS_NEW=1,e.DataManager.STATUS_MODIFIED=2,e.DataManager.STATUS_REMOVED=0}(AeroGear,jQuery),function(e,t,a){e.DataManager.adapters.Memory=function(t,r){if(!(this instanceof e.DataManager.adapters.Memory))return new e.DataManager.adapters.Memory(t,r);r=r||{};var s=r.recordId?r.recordId:"id",n=null,o=!!r.dataSync;this.getRecordId=function(){return s},this.getData=function(t){var a,r,s=[];if(o&&!t){for(a in n)r=n[a]["ag-sync-status"],r!==e.DataManager.STATUS_REMOVED&&s.push(n[a]);return s}return n},this.setData=function(t){if(o)for(var a in t)t[a]["ag-sync-status"]=e.DataManager.STATUS_NEW;n=t},this.emptyData=function(){if(o)for(var t in n)n[t]["ag-sync-status"]=e.DataManager.STATUS_REMOVED;else n=null},this.addDataRecord=function(t){n=n||[],o&&(t["ag-sync-status"]=e.DataManager.STATUS_NEW,t.id=t.id||a()),n.push(t)},this.updateDataRecord=function(t,a){o&&(a["ag-sync-status"]=e.DataManager.STATUS_MODIFIED),n[t]=a},this.removeDataRecord=function(t){o?n[t]["ag-sync-status"]=e.DataManager.STATUS_REMOVED:n.splice(t,1)},this.getDataSync=function(){return o},this.traverseObjects=function(e,t,a){for(;"object"==typeof t&&a;)e=Object.keys(t)[0],t=t[e],a=a[e];return t===a?!0:!1}},e.DataManager.adapters.Memory.prototype.read=function(e){var t={};return t[this.getRecordId()]=e,e?this.filter(t):this.getData()},e.DataManager.adapters.Memory.prototype.save=function(t,a){var r=!1;if(t=e.isArray(t)?t:[t],a)this.setData(t);else if(this.getData())for(var s=0;t.length>s;s++){for(var n in this.getData())if(this.getData()[n][this.getRecordId()]===t[s][this.getRecordId()]){this.updateDataRecord(n,t[s]),r=!0;break}r||this.addDataRecord(t[s]),r=!1}else this.setData(t);return this.getData()},e.DataManager.adapters.Memory.prototype.remove=function(t){if(!t)return this.emptyData(),this.getData();t=e.isArray(t)?t:[t];for(var a,r,s,n=0;t.length>n;n++){if("string"==typeof t[n]||"number"==typeof t[n])a=t[n];else{if(!t)continue;a=t[n][this.getRecordId()]}r=this.getData(!0);for(s in r)r[s][this.getRecordId()]===a&&this.removeDataRecord(s)}return this.getData()},e.DataManager.adapters.Memory.prototype.filter=function(a,r){var s,n,o,i,u,c=this;return s=a?this.getData().filter(function(s){var h,p,f=r?!1:!0,d=Object.keys(a);for(n=0;d.length>n;n++){if(a[d[n]].data)for(h=a[d[n]],p=h.matchAny?!1:!0,o=0;h.data.length>o;o++)if(e.isArray(s[d[n]]))if(s[d[n]].length){if(0===t(s[d]).not(h.data).length&&0===t(h.data).not(s[d]).length){p=!0;break}for(i=0;s[d[n]].length>i;i++){if(h.matchAny&&h.data[o]===s[d[n]][i]){if(p=!0,r)break;for(u=0;s[d[n]].length>u;u++)if(!r&&h.data[o]!==s[d[n]][u]){p=!1;break}}if(!h.matchAny&&h.data[o]!==s[d[n]][i]){p=!1;break}}}else p=!1;else if("object"==typeof h.data[o]){if(h.matchAny&&c.traverseObjects(d[n],h.data[o],s[d[n]])){p=!0;break}if(!h.matchAny&&!c.traverseObjects(d[n],h.data[o],s[d[n]])){p=!1;break}}else{if(h.matchAny&&h.data[o]===s[d[n]]){p=!0;break}if(!h.matchAny&&h.data[o]!==s[d[n]]){p=!1;break}}else if(e.isArray(s[d[n]]))if(p=r?!1:!0,s[d[n]].length)for(o=0;s[d[n]].length>o;o++){if(r&&a[d[n]]===s[d[n]][o]){p=!0;break}if(!r&&a[d[n]]!==s[d[n]][o]){p=!1;break}}else p=!1;else p="object"==typeof a[d[n]]?c.traverseObjects(d[n],a[d[n]],s[d[n]]):a[d[n]]===s[d[n]]?!0:!1;if(r&&p){f=!0;break}if(!r&&!p){f=!1;break}}return f}):this.getData()||[]}}(AeroGear,jQuery,uuid),function(e){e.DataManager.adapters.SessionLocal=function(t,a){if(!(this instanceof e.DataManager.adapters.SessionLocal))return new e.DataManager.adapters.SessionLocal(t,a);e.DataManager.adapters.Memory.apply(this,arguments);var r=a.storageType||"sessionStorage",s=t,n=(a.dataSync,document.location.pathname.replace(/[\/\.]/g,"-")),o=s+n,i=JSON.parse(window[r].getItem(o));i&&e.DataManager.adapters.Memory.prototype.save.call(this,i,!0),this.getStoreType=function(){return r},this.getStoreKey=function(){return o}},e.DataManager.adapters.SessionLocal.prototype=Object.create(new e.DataManager.adapters.Memory,{save:{value:function(t,a){e.DataManager.adapters.Memory.prototype.save.apply(this,arguments);try{window[this.getStoreType()].setItem(this.getStoreKey(),JSON.stringify(this.getData())),a&&a.storageSuccess&&a.storageSuccess(t)}catch(r){if(!a||!a.storageError)throw r;a.storageError(r,t)}},enumerable:!0,configurable:!0,writable:!0},remove:{value:function(){e.DataManager.adapters.Memory.prototype.remove.apply(this,arguments),window[this.getStoreType()].setItem(this.getStoreKey(),JSON.stringify(this.getData()))},enumerable:!0,configurable:!0,writable:!0}})}(AeroGear,jQuery,uuid),function(e){e.Auth=function(t){return this instanceof e.Auth?(e.Core.call(this),this.lib="Auth",this.type=t?t.type||"Rest":"Rest",this.collectionName="modules",this.add(t),undefined):new e.Auth(t)},e.Auth.prototype=e.Core,e.Auth.constructor=e.Auth,e.Auth.adapters={}}(AeroGear,jQuery),function(e,t){e.Auth.adapters.Rest=function(a,r){if(!(this instanceof e.Auth.adapters.Rest))return new e.Auth.adapters.Rest(a,r);r=r||{};var s=r.endpoints||{},n=a,o=!!r.agAuth,i=r.baseURL,u=r.tokenName||"Auth-Token";this.isAuthenticated=function(){return o?!!sessionStorage.getItem("ag-auth-"+n):!0},this.addAuthIdentifier=function(e){return e.headers={},e.headers[u]=sessionStorage.getItem("ag-auth-"+n),t.extend({},e)},this.deauthorize=function(){sessionStorage.removeItem("ag-auth-"+n)},this.getSettings=function(){return r},this.getEndpoints=function(){return s},this.getName=function(){return n},this.getAGAuth=function(){return o},this.getBaseURL=function(){return i},this.getTokenName=function(){return u}},e.Auth.adapters.Rest.prototype.enroll=function(e,a){a=a||{};var r=this,s=this.getName(),n=this.getTokenName(),o=this.getBaseURL(),i=this.getEndpoints(),u=this.getAGAuth(),c=function(e,t,o){sessionStorage.setItem("ag-auth-"+s,r.getAGAuth()?o.getResponseHeader(n):"true"),a.success&&a.success.apply(this,arguments)},h=function(e,t,r){var s;try{e.responseJSON=JSON.parse(e.responseText),s=[e,t,r]}catch(n){s=arguments}a.error&&a.error.apply(this,s)},p={success:c,error:h,data:e},f="";return a.contentType?p.contentType=a.contentType:u&&(p.contentType="application/json"),a.dataType?p.dataType=a.dataType:u&&(p.dataType="json"),a.baseURL?f=a.baseURL:o&&(f=o),f+=i.enroll?i.enroll:"auth/enroll",f.length&&(p.url=f),t.ajax(t.extend({},this.getSettings(),{type:"POST"},p))},e.Auth.adapters.Rest.prototype.login=function(e,a){a=a||{};var r=this,s=this.getName(),n=this.getTokenName(),o=this.getBaseURL(),i=this.getEndpoints(),u=this.getAGAuth(),c=function(e,t,o){sessionStorage.setItem("ag-auth-"+s,r.getAGAuth()?o.getResponseHeader(n):"true"),a.success&&a.success.apply(this,arguments)},h=function(e,t,r){var s;try{e.responseJSON=JSON.parse(e.responseText),s=[e,t,r]}catch(n){s=arguments}a.error&&a.error.apply(this,s)},p={success:c,error:h,data:e},f="";return a.contentType?p.contentType=a.contentType:u&&(p.contentType="application/json"),a.dataType?p.dataType=a.dataType:u&&(p.dataType="json"),a.baseURL?f=a.baseURL:o&&(f=o),f+=i.login?i.login:"auth/login",f.length&&(p.url=f),t.ajax(t.extend({},this.getSettings(),{type:"POST"},p))},e.Auth.adapters.Rest.prototype.logout=function(e){e=e||{};var a=this,r=this.getName(),s=this.getTokenName(),n=this.getBaseURL(),o=this.getEndpoints(),i=function(){a.deauthorize(),e.success&&e.success.apply(this,arguments)},u=function(t,a,r){var s;try{t.responseJSON=JSON.parse(t.responseText),s=[t,a,r]}catch(n){s=arguments}e.error&&e.error.apply(this,s)},c={success:i,error:u},h="";return e.baseURL?h=e.baseURL:n&&(h=n),h+=o.logout?o.logout:"auth/logout",h.length&&(c.url=h),this.isAuthenticated()&&(c.headers={},c.headers[s]=sessionStorage.getItem("ag-auth-"+r)),t.ajax(t.extend({},this.getSettings(),{type:"POST"},c))}}(AeroGear,jQuery);
//@ sourceMappingURL=aerogear.js.map