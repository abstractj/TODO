/*! AeroGear JavaScript Library - v1.0.0.Alpha - 2012-08-10
* https://github.com/aerogear/aerogear-js
* Copyright (c) 2012 AeroGear Team and contributors; Licensed ALv2 */
(function(a,b){var c=a.aerogear={}})(this),function(a,b){function c(a){return{}.toString.call(a)==="[object Array]"}a.pipeline=function(b){var d={};return d.add=function(b){var e,f,g=d.pipes=d.pipes||{};if(typeof b=="string")g[b]=a.pipeline.adapters.rest(b,"id");else if(c(b))for(e=0;e<b.length;e++)f=b[e],typeof f=="string"?g[f]=a.pipeline.adapters.rest(f):g[f.name]=a.pipeline.adapters[f.type||"rest"](f.name,f.recordId||"id",f.settings||{});else if(b)g[b.name]=a.pipeline.adapters[b.type||"rest"](b.name,b.recordId||"id",b.settings||{});else throw"aerogear.pipeline: pipe is undefined";return d.pipes=g,d},d.remove=function(a){var b,e,f=d.pipes=d.pipes||{};if(typeof a=="string")delete f[a];else if(c(a))for(b=0;b<a.length;b++)e=a[b],typeof e=="string"?delete f[e]:delete f[e.name];else a&&delete f[a.name];return d.pipes=f,d},d.add(b)},a.pipeline.adapters={}}(aerogear),function(a,b,c){a.pipeline.adapters.rest=function(a,c,d){return d=b.extend({url:a,contentType:"application/json"},d),{recordId:c,type:"rest",data:{},read:function(a){var c=this,e;a?(a.ajax&&a.ajax.data?e=a.ajax.data:a.data?e=a.data:a.ajax||(a.ajax={}),e&&(a.ajax.data=e)):a={ajax:{}};var f=function(b){c.data=b,a.ajax.success&&a.ajax.success.apply(this,arguments)};return b.ajax(b.extend({},d,{type:"GET"},a.ajax,{success:f}))},save:function(a,c){var e,f;return a=a||{},c=c||{},e=a[this.recordId]?"PUT":"POST",!c.ajax.url&&a[this.recordId]?f=d.url+"/"+a[this.recordId]:c.ajax.url?f=c.ajax.url:f=d.url,typeof a!="string"&&(a=JSON.stringify(a)),b.ajax(b.extend({},d,{data:a,type:e,url:f},c.ajax||{}))},del:function(a){var c="",e;return a=a||{},typeof a=="string"||typeof a=="number"?c=""+a:typeof a.record=="string"||typeof a.record=="number"?c=""+a.record:a.record&&(c=""+a.record[this.recordId]),c=c.length?"/"+c:"",a.ajax?a.ajax.url?e=a.ajax.url:e=d.url+c:e=d.url+c,b.ajax(b.extend({},d,{type:"DELETE",url:e},a.ajax||{}))}}}}(aerogear,jQuery);