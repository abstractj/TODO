/*! AeroGear JavaScript Library - v1.0.0.Alpha - 2012-08-16
* https://github.com/aerogear/aerogear-js
* JBoss, Home of Professional Open Source
* Copyright 2012, Red Hat, Inc., and individual contributors
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
(function(a,b){var c=a.aerogear={}})(this),function(a,b){function c(a){return{}.toString.call(a)==="[object Array]"}a.pipeline=function(b){var d={};return d.add=function(b){var e,f,g=d.pipes=d.pipes||{};if(typeof b=="string")g[b]=a.pipeline.adapters.rest(b,"id");else if(c(b))for(e=0;e<b.length;e++)f=b[e],typeof f=="string"?g[f]=a.pipeline.adapters.rest(f):g[f.name]=a.pipeline.adapters[f.type||"rest"](f.name,f.recordId||"id",f.settings||{});else if(b)g[b.name]=a.pipeline.adapters[b.type||"rest"](b.name,b.recordId||"id",b.settings||{});else throw"aerogear.pipeline: pipe is undefined";return d.pipes=g,d},d.remove=function(a){var b,e,f=d.pipes=d.pipes||{};if(typeof a=="string")delete f[a];else if(c(a))for(b=0;b<a.length;b++)e=a[b],typeof e=="string"?delete f[e]:delete f[e.name];else a&&delete f[a.name];return d.pipes=f,d},d.add(b)},a.pipeline.adapters={}}(aerogear),function(a,b,c){a.pipeline.adapters.rest=function(a,c,d){return d=b.extend({url:a,contentType:"application/json",dataType:"json"},d),{recordId:c,type:"rest",data:{},read:function(a){var c=this,e;a?(a.ajax&&a.ajax.data?e=a.ajax.data:a.data?e=a.data:a.ajax||(a.ajax={}),e&&(a.ajax.data=e)):a={ajax:{}};var f=function(b){c.data=b,a.ajax.success&&a.ajax.success.apply(this,arguments)};return b.ajax(b.extend({},d,{type:"GET"},a.ajax,{success:f}))},save:function(a,c){var e,f;return a=a||{},c=c||{},e=a[this.recordId]?"PUT":"POST",!c.ajax.url&&a[this.recordId]?f=d.url+"/"+a[this.recordId]:c.ajax.url?f=c.ajax.url:f=d.url,typeof a!="string"&&(a=JSON.stringify(a)),b.ajax(b.extend({},d,{data:a,type:e,url:f},c.ajax||{}))},remove:function(a,c){var e="",f;c=c||{};if(typeof a=="string"||typeof a=="number")e=""+a;else if(a)typeof a.record=="string"||typeof a.record=="number"?e=""+a.record:a.record&&(e=""+a.record[this.recordId]);else throw"aerogear.pipeline.rest: missing argument";return e=e.length?"/"+e:"",c.ajax?c.ajax.url?f=c.ajax.url:f=d.url+e:a.ajax?(c.ajax=a.ajax,a.ajax.url?f=a.ajax.url:f=d.url+e):f=d.url+e,b.ajax(b.extend({},d,{type:"DELETE",url:f},c.ajax||{}))}}}}(aerogear,jQuery);